#ifndef __STATS_H__
#define __STATS_H__

#include <map>
#include <string>
#include <set>
#include <experimental/filesystem>
#include "istats.h"
#include <iostream>
#include "iutils.h"

namespace fs = std::experimental::filesystem;

namespace ft {
////////////////////////////////////////////////////////////////////////
/// \copyright Copyright (c) 2019, Wasserman lab
/// \author    Godfrain Jacques Kounkou
/// \brief This file contains the declaration of stats.h, it contains
///             all functions necessary to generate some stats or related
///             stats contents
////////////////////////////////////////////////////////////////////////
class Stats : public IStats {
public:
    ////////////////////////////////////////////////////////////////////////
    /// \brief Stats
    ////////////////////////////////////////////////////////////////////////
    Stats();

    ////////////////////////////////////////////////////////////////////////
    /// \brief ~Stats
    ////////////////////////////////////////////////////////////////////////
    virtual ~Stats();

    ////////////////////////////////////////////////////////////////////////
    /// \brief printKmerCountToFile
    /// \param outputFile
    /// \param counter
    ////////////////////////////////////////////////////////////////////////
    void printKmerCountToFile(const fs::path& outputFile, std::map<std::string, uint>& counter) const;

    ////////////////////////////////////////////////////////////////////////
    /// \brief Stats::printKmerSearchTimeToFile
    /// \param outputFile
    /// \param kmer
    /// \param time
    ////////////////////////////////////////////////////////////////////////
    void printKmerSearchTimeToFile(const fs::path& outputFile, const std::string& kmer, uint time) const;

    ////////////////////////////////////////////////////////////////////////
    /// \brief printMatchingReadsToFile
    /// \param outputFile
    /// \param read
    ////////////////////////////////////////////////////////////////////////
    void  printMatchingReadsToFile(const fs::path& outputFile, const std::string& read, ReaIDsMap& res) const;
};
}

#endif // __STATS_H__
